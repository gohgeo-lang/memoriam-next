generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id             Int             @id @default(autoincrement())
  email          String          @unique
  password       String
  name           String?
  createdAt      DateTime        @default(now())
  image          String?
  Address        Address[]
  comments       Comment[]
  Family         Family[]
  paymentMethods PaymentMethod[]
  pointHistories PointHistory[]
  posts          Post[]
  remembers      Postremember[]
}

model PostCategory {
  id    Int    @id @default(autoincrement())
  name  String @unique
  posts Post[]
}

model Post {
  id           Int            @id @default(autoincrement())
  title        String
  content      String
  published    Boolean        @default(false)
  createdAt    DateTime       @default(now())
  authorId     Int
  categoryId   Int
  comments     Comment[]
  author       User           @relation(fields: [authorId], references: [id])
  category     PostCategory   @relation(fields: [categoryId], references: [id])
  PostMemorial PostMemorial?
  remembers    Postremember[]

  @@map("Post")
}

model PostMemorial {
  id            Int     @id @default(autoincrement())
  petName       String
  ownerName     String
  thumbnailUrl  String?
  rememberCount Int     @default(0)
  postId        Int     @unique
  post          Post    @relation(fields: [postId], references: [id], onDelete: Cascade)
}

model Comment {
  id        Int      @id @default(autoincrement())
  content   String
  createdAt DateTime @default(now())
  postId    Int
  authorId  Int?
  author    User?    @relation(fields: [authorId], references: [id])
  post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@map("Comment")
}

model Postremember {
  id        Int      @id @default(autoincrement())
  userId    Int
  postId    Int
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id])
  post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@unique([userId, postId])
  @@map("Postremember")
}

model Family {
  id        Int       @id @default(autoincrement())
  userId    Int
  name      String
  species   String
  breed     String?
  birthDate DateTime?
  photo     String?
  memo      String?
  createdAt DateTime  @default(now())
  user      User      @relation(fields: [userId], references: [id])
}

model Address {
  id        Int      @id @default(autoincrement())
  userId    Int
  name      String
  phone     String
  address   String
  detail    String?
  isDefault Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  user      User     @relation(fields: [userId], references: [id])
}

model PaymentMethod {
  id         Int      @id @default(autoincrement())
  userId     Int
  carName    String
  cardNumber String
  expiry     String
  isDefault  Boolean  @default(false)
  createdAt  DateTime @default(now())
  user       User     @relation(fields: [userId], references: [id])
}

model PointHistory {
  id          Int      @id @default(autoincrement())
  userId      Int
  type        String
  amount      Int
  description String?
  createdAt   DateTime @default(now())
  user        User     @relation(fields: [userId], references: [id])
}
